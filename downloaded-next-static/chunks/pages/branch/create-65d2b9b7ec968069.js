(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1246],{89081:function(e,l,a){"use strict";a.d(l,{Z:function(){return t}});var t=(0,a(30853).Z)("device-mobile","IconDeviceMobile",[["path",{d:"M6 5a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2v-14z",key:"svg-0"}],["path",{d:"M11 4h2",key:"svg-1"}],["path",{d:"M12 17v.01",key:"svg-2"}]])},32510:function(e,l,a){"use strict";a.d(l,{Z:function(){return t}});var t=(0,a(30853).Z)("map","IconMap",[["path",{d:"M3 7l6 -3l6 3l6 -3v13l-6 3l-6 -3l-6 3v-13",key:"svg-0"}],["path",{d:"M9 4v13",key:"svg-1"}],["path",{d:"M15 7v13",key:"svg-2"}]])},2891:function(e,l,a){"use strict";a.d(l,{Z:function(){return t}});var t=(0,a(30853).Z)("map-pin","IconMapPin",[["path",{d:"M9 11a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-0"}],["path",{d:"M17.657 16.657l-4.243 4.243a2 2 0 0 1 -2.827 0l-4.244 -4.243a8 8 0 1 1 11.314 0z",key:"svg-1"}]])},81421:function(e,l,a){"use strict";a.d(l,{Z:function(){return t}});var t=(0,a(30853).Z)("phone-call","IconPhoneCall",[["path",{d:"M5 4h4l2 5l-2.5 1.5a11 11 0 0 0 5 5l1.5 -2.5l5 2v4a2 2 0 0 1 -2 2a16 16 0 0 1 -15 -15a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M15 7a2 2 0 0 1 2 2",key:"svg-1"}],["path",{d:"M15 3a6 6 0 0 1 6 6",key:"svg-2"}]])},74876:function(e,l,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/branch/create",function(){return a(97392)}])},60894:function(e,l,a){"use strict";var t=a(18992);let s="/api/v1";l.Z={find:async()=>{try{var e;let l=await t.Z.get("".concat(s,"/region"));return{success:!0,data:null==l?void 0:null===(e=l.data)||void 0===e?void 0:e.data}}catch(e){return{success:!1,e}}},create:async(e,l)=>{var a,n,r,o,i;try{let n=await t.Z.post("".concat(s,"/createRegion"),{...e,staff:l});return{success:!0,data:null==n?void 0:null===(a=n.data)||void 0===a?void 0:a.data}}catch(e){return{success:!1,e:(null==e?void 0:null===(r=e.response)||void 0===r?void 0:null===(n=r.data)||void 0===n?void 0:n.error)||(null==e?void 0:null===(i=e.response)||void 0===i?void 0:null===(o=i.data)||void 0===o?void 0:o.message)}}}}},97392:function(e,l,a){"use strict";a.r(l);var t=a(85893),s=a(74886),n=a(60894),r=a(26148),o=a(43681),i=a(34085),c=a(25130),u=a(60946),d=a(25832),m=a(95085),p=a(36616),v=a(86414),h=a(70140),f=a(47181),b=a(10330),x=a(2891),g=a(32510),j=a(75928),_=a(81421),y=a(89081),N=a(88198),w=a(11163),P=a(67294),A=a(88767);let BranchCreate=()=>{let e=(0,w.useRouter)(),{user:l}=(0,o.a)(),[a,i]=(0,P.useState)(!1),[c,S]=(0,P.useState)(),[Z,F]=(0,P.useState)(),[k,M]=(0,P.useState)();(0,P.useEffect)(()=>{(null==l?void 0:l.role)==="customer"&&I.setFieldValue("user_id",(null==l?void 0:l.user_id)||null),((null==l?void 0:l.role)==="admin"||(null==l?void 0:l.role)==="manager"||(null==l?void 0:l.role)==="operator")&&I.setFieldValue("approve",1)},[l]),(0,P.useEffect)(()=>{F(null),M(null),I.setFieldValue("district",null)},[c]),(0,P.useEffect)(()=>{M(null),I.setFieldValue("committee",null)},[Z]);let I=(0,b.c)({initialValues:{user_id:null,name:"",city:"",district:null,committee:null,street:"",toot:"",region:"",branch_phone:null,branch_addition:""},validate:{user_id:e=>null===e?"Харилцагч сонгоно уу.":null,city:e=>e.length<=0?"Хот/аймаг оруулна уу.":null,district:e=>null===e?"Cум/дүүрэг оруулна уу":null,street:e=>e.length<=0?"Орц/гудамж оруулна уу":null,toot:e=>e.length<=0?"Давхар-тоот оруулна уу":null,region:e=>e.length<=0?"Бүс оруулна уу":null,branch_phone:e=>null===e?"Дугаар оруулна уу":""===e?"Тоо оруулна уу":null,branch_addition:e=>e.length<=0?"Хаяг нэмэлт мэдээлэл оруулна уу":null}}),{data:C}=(0,A.useQuery)(["branch-list-userId",l,I.values.user_id],()=>r.Z.getBranchByUserId((null==l?void 0:l.role)==="admin"?I.values.user_id:null==l?void 0:l.user_id));(0,P.useEffect)(()=>{let e=null==C?void 0:C.length;I.setFieldValue("name",0===e?"Үндсэн салбар":"Салбар ".concat(e+1||""))},[C]);let{data:D}=(0,A.useQuery)(["user-list-branch"],()=>r.Z.find(),{enabled:(null==l?void 0:l.role)!="customer"}),{data:z}=(0,A.useQuery)(["region-list"],()=>n.Z.find()),{data:E}=(0,A.useQuery)(["khoroo-list",Z],()=>Z?s.Z.find(Z):Promise.reject()),O=(0,A.useMutation)(["create-branch"],e=>r.Z.createBranch(e,null==l?void 0:l.last_name),{onSuccess(a){(null==a?void 0:a.success)===!0?((null==l?void 0:l.role)!=="admin"?i(!0):e.back(),(0,u.PV)({message:"Салбар нэмэгдлээ",status:!0})):(0,u.PV)({message:null==a?void 0:a.e,status:!1})}}),handleSubmit=e=>{O.mutateAsync(e)};return(0,t.jsxs)("div",{className:"pr-5",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center text-indigo-600",children:[(0,t.jsxs)("div",{className:"flex items-center bg-indigo-200 rounded-md py-1.5 px-2.5 space-x-1.5 cursor-pointer",onClick:()=>e.back(),children:[(0,t.jsx)("img",{src:"/icons/arrow-left.svg",alt:"left",className:"w-5"}),(0,t.jsx)("p",{className:"font-semibold text-sm",children:"Буцах"})]}),(0,t.jsx)("p",{className:"font-bold",children:"Салбар байршил нэмэх"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl w-full 2xl:h-[778px] xl:h-100vh mt-4 px-8 py-5 flex flex-col justify-start",children:[!1===a&&(0,t.jsx)("div",{className:"flex items-center justify-center",children:(0,t.jsx)("p",{className:"text-indigo-600 font-bold text-2xl mt-2 mb-5",children:I.values.name})}),(0,t.jsx)(m.f,{visible:null==O?void 0:O.isLoading}),!1===a?(0,t.jsxs)("form",{className:"2xl:mx-96 xl:mx-60",onSubmit:I.onSubmit(e=>handleSubmit(e)),children:[("admin"===l.role||"manager"===l.role||"operator"===l.role)&&(0,t.jsx)(p.P,{searchable:!0,clearable:!0,data:((null==D?void 0:D.data)||[]).filter(e=>(null==e?void 0:e.role)==="customer").map(e=>({label:(null==e?void 0:e.shop_name)||"",value:null==e?void 0:e.user_id.toString()})),onChange:e=>{I.setFieldValue("user_id",e)},label:"Харилцагч сонгох",leftSection:(0,t.jsx)(x.Z,{size:"1.5rem",color:"#6A5ADF"}),placeholder:"Заавал бөглөх",mb:20,className:"w-full"}),(0,t.jsxs)("div",{className:"flex space-x-6",children:[(0,t.jsx)(p.P,{data:(d.n||[]).map(e=>({label:(null==e?void 0:e.value)||"",value:null==e?void 0:e.value.toString()})),onChange:e=>{S(e),I.setFieldValue("city",e)},clearable:!0,searchable:!0,label:"Хот/аймаг",leftSection:(0,t.jsx)(x.Z,{size:"1.5rem",color:"#6A5ADF"}),placeholder:"Заавал бөглөх",mb:20,className:"w-full"}),(0,t.jsx)(p.P,{label:"Cум/дүүрэг",nothingFoundMessage:"Хот/аймаг сонгоно уу!",searchable:!0,clearable:!0,data:(d.g||[]).filter(e=>e.value===c).map(e=>({label:(null==e?void 0:e.label)||"",value:null==e?void 0:e.label.toString()})),onChange:e=>{F(e),I.setFieldValue("district",e)},value:Z,leftSection:(0,t.jsx)(x.Z,{size:"1.5rem",color:"#6A5ADF"}),placeholder:"Заавал бөглөх",mb:20,className:"w-full"})]}),(0,t.jsxs)("div",{className:"flex space-x-6",children:[(0,t.jsx)(p.P,{searchable:!0,clearable:!0,nothingFoundMessage:"Сум/дүүрэг сонгоно уу!",label:"Баг/хороо",data:((null==E?void 0:E.data)||[]).map(e=>({label:(null==e?void 0:e.name)||"",value:null==e?void 0:e.name.toString()})),onChange:e=>{M(e),I.setFieldValue("committee",e)},leftSection:(0,t.jsx)(x.Z,{size:"1.5rem",color:"#6A5ADF"}),placeholder:"Баг/хороо оруулна уу",mb:20,value:k,className:"w-full"}),(0,t.jsx)(p.P,{label:"Бүс",data:((null==z?void 0:z.data)||[]).map(e=>({value:(null==e?void 0:e.name)||"",label:(null==e?void 0:e.name)||""})),clearable:!0,leftSection:(0,t.jsx)(g.Z,{size:"1.5rem",color:"#6A5ADF"}),placeholder:"Заавал бөглөх",...I.getInputProps("region"),mb:20,className:"w-full"})]}),(0,t.jsx)(v.o,{label:"Хотхон - Байр/барилга (Заавал биш)",leftSection:(0,t.jsx)(j.Z,{size:"1.5rem",color:"#6A5ADF"}),placeholder:"Жн: Алтай хотхон 8р байр...",...I.getInputProps("branch_address"),mb:20,className:"w-full"}),(0,t.jsxs)("div",{className:"flex space-x-6",children:[(0,t.jsx)(v.o,{label:"Орц/гудамж",leftSection:(0,t.jsx)(x.Z,{size:"1.5rem",color:"#6A5ADF"}),placeholder:"Жн: 4р орц",...I.getInputProps("street"),mb:20,className:"w-full"}),(0,t.jsx)(v.o,{label:"Давхар-тоот",leftSection:(0,t.jsx)(x.Z,{size:"1.5rem",color:"#6A5ADF"}),placeholder:"Жн: 12 давхар1205 тоот",...I.getInputProps("toot"),mb:20,className:"w-full"})]}),(0,t.jsxs)("div",{className:"flex space-x-6",children:[(0,t.jsx)(v.o,{label:"Салбарын дугаар",leftSection:(0,t.jsx)(_.Z,{size:"1.5rem",color:"#6A5ADF"}),placeholder:"Холбогдох дугаар",...I.getInputProps("branch_phone"),mb:20,type:"number",className:"w-full"}),(0,t.jsx)(v.o,{label:" ",leftSection:(0,t.jsx)(y.Z,{size:"1.5rem",color:"#6A5ADF"}),placeholder:"Яаралтай үед холбогдох дугаар",...I.getInputProps("branch_phone1"),mb:20,type:"number",className:"w-full"})]}),(0,t.jsx)(v.o,{label:"Хаяг нэмэлт мэдээлэл",placeholder:"Жн: Орцны код нь 1234 шүү, Анхаар нохойтой гэх мэт ...",...I.getInputProps("branch_addition"),mb:20,className:"w-full"}),(0,t.jsx)(h.Z,{justify:"center",mt:"md",children:(0,t.jsx)(f.z,{color:"#6A5ADF",radius:"md",type:"submit",rightSection:(0,t.jsx)(N.Z,{}),children:"Хадгалах"})})]}):(0,t.jsxs)("div",{className:"flex justify-center items-center flex-col py-60",children:[(0,t.jsx)("img",{src:"/icons/successful.svg",alt:"successful"}),(0,t.jsxs)("h1",{className:"text-lime-600 text-center text-xl font-bold mt-5",children:["Таны салбар үүсгэх хүсэлт амжилттай илгээгдлээ."," ",(0,t.jsxs)("div",{children:["Бид танд 72 цагийн дотор хариу илгээх болно. Дугаар:"," ",(0,t.jsx)("span",{children:"77072002"})]})]}),(0,t.jsx)(f.z,{color:"#6A5ADF",mt:50,radius:"md",leftSection:(0,t.jsx)("img",{src:"/icons/arrow-left-light.svg",className:"stroke-white",alt:"icon"}),onClick:()=>e.back(),children:"Буцах"})]})]})]})};l.default=BranchCreate,BranchCreate.getLayout=e=>(0,t.jsx)(i.Z,{canSee:[c.K.ADMIN,c.K.CUSTOMER,c.K.MANAGER,c.K.OPERATOR],children:e})},86414:function(e,l,a){"use strict";a.d(l,{o:function(){return v}});var t=a(67294),s=a(12440),n=a(9535),r=a(90987),o=Object.defineProperty,i=Object.defineProperties,c=Object.getOwnPropertyDescriptors,u=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,l,a)=>l in e?o(e,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[l]=a,__spreadValues=(e,l)=>{for(var a in l||(l={}))d.call(l,a)&&__defNormalProp(e,a,l[a]);if(u)for(var a of u(l))m.call(l,a)&&__defNormalProp(e,a,l[a]);return e},__spreadProps=(e,l)=>i(e,c(l));let p={},v=(0,n.d)((e,l)=>{let a=(0,r.w)("TextInput",p,e);return t.createElement(s.M,__spreadProps(__spreadValues({component:"input",ref:l},a),{__staticSelector:"TextInput"}))});v.classes=s.M.classes,v.displayName="@mantine/core/TextInput"}},function(e){e.O(0,[2251,5471,3062,9604,6616,330,2929,6148,4480,9774,2888,179],function(){return e(e.s=74876)}),_N_E=e.O()}]);
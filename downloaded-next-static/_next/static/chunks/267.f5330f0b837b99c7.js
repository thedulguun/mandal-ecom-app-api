"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[267],{78426:function(e,l,a){var d=a(18992);let t="/api/v1";l.Z={getTotal:async(e,l,a)=>{try{let i=await d.Z.get("".concat(t,"/getDeliveryTotal"),{params:{table:e,id:a,table2:l}});return{success:!0,data:null==i?void 0:i.data}}catch(e){var i,s,o,n;return{success:!1,e:(null==e?void 0:null===(s=e.response)||void 0===s?void 0:null===(i=s.data)||void 0===i?void 0:i.error)||(null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(o=n.data)||void 0===o?void 0:o.message)}}},getReport:async e=>{var l,a,i,s,o;try{let a=await d.Z.get("".concat(t,"/getReportDashboard"),{params:{user_id:e}});return{success:!0,data:null==a?void 0:null===(l=a.data)||void 0===l?void 0:l.data}}catch(e){return{success:!1,e:(null==e?void 0:null===(i=e.response)||void 0===i?void 0:null===(a=i.data)||void 0===a?void 0:a.error)||(null==e?void 0:null===(o=e.response)||void 0===o?void 0:null===(s=o.data)||void 0===s?void 0:s.message)}}},getDeliveryCount:async e=>{var l,a,i,s,o;try{let a=await d.Z.get("".concat(t,"/getDeliveryChart"),{params:{user_id:e}});return{success:!0,data:null==a?void 0:null===(l=a.data)||void 0===l?void 0:l.data}}catch(e){return{success:!1,e:(null==e?void 0:null===(i=e.response)||void 0===i?void 0:null===(a=i.data)||void 0===a?void 0:a.error)||(null==e?void 0:null===(o=e.response)||void 0===o?void 0:null===(s=o.data)||void 0===s?void 0:s.message)}}},action_log:async(e,l,a)=>{var i,s,o,n,r,c;try{let o=await d.Z.get("".concat(t,"/action_log"),{params:{startLimit:e,endLimit:l,search:a}});return{success:!0,data:null==o?void 0:null===(i=o.data)||void 0===i?void 0:i.data,pagination:null==o?void 0:null===(s=o.data)||void 0===s?void 0:s.pagination}}catch(e){return{success:!1,e:(null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(o=n.data)||void 0===o?void 0:o.error)||(null==e?void 0:null===(c=e.response)||void 0===c?void 0:null===(r=c.data)||void 0===r?void 0:r.message)}}}}},46614:function(e,l,a){var d=a(18992),t=a(27484),i=a.n(t);let s="/api/v1";l.Z={find:async(e,l,a,t,o,n,r,c,u,v,m,x,h,p,g)=>{try{var y,f;let j=await d.Z.get("".concat(s,"/delivery"),{params:{startLimit:e,endLimit:l,order:a,sort:t,search:o,value:n,startDate:r?i()(r).format("YYYY-MM-DD 00:00:00"):null,endDate:c?i()(c).format("YYYY-MM-DD 23:59:59"):null,status:u,value1:v,value2:m,order1:x,order2:h,action:p,type:g}});return{success:!0,data:null==j?void 0:null===(y=j.data)||void 0===y?void 0:y.data,pagination:null==j?void 0:null===(f=j.data)||void 0===f?void 0:f.pagination}}catch(e){return{success:!1,e}}},findWithArchive:async(e,l,a,t,o,n,r,c,u,v,m,x,h,p)=>{try{var g,y;let f=await d.Z.get("".concat(s,"/deliveryWithArchive"),{params:{startLimit:e,endLimit:l,order:a,sort:t,search:o,value:n,startDate:r?i()(r).format("YYYY-MM-DD 00:00:00"):null,endDate:c?i()(c).format("YYYY-MM-DD 23:59:59"):null,status:u,value1:v,value2:m,order1:x,order2:h,action:p}});return{success:!0,data:null==f?void 0:null===(g=f.data)||void 0===g?void 0:g.data,pagination:null==f?void 0:null===(y=f.data)||void 0===y?void 0:y.pagination}}catch(e){return{success:!1,e}}},find_items_by_id:async e=>{var l,a,t,i,o;try{let a=await d.Z.get("".concat(s,"/getDelivery_items_by_id"),{params:{id:e}});return{success:!0,data:null==a?void 0:null===(l=a.data)||void 0===l?void 0:l.data}}catch(e){return{success:!1,e:(null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.error)||(null==e?void 0:null===(o=e.response)||void 0===o?void 0:null===(i=o.data)||void 0===i?void 0:i.message)}}},getDelivery_items:async(e,l,a,t,i,o)=>{try{var n,r;let c=await d.Z.get("".concat(s,"/getDelivery_items"),{params:{startLimit:e,endLimit:l,order:a,sort:t,search:i,groupBy:o}});return{success:!0,data:null==c?void 0:null===(n=c.data)||void 0===n?void 0:n.data,pagination:null==c?void 0:null===(r=c.data)||void 0===r?void 0:r.pagination}}catch(e){return{success:!1,e}}},create:async(e,l)=>{var a,t,i,o,n;try{let t=await d.Z.post("".concat(s,"/createDelivery"),{...e,staff:l});return{success:!0,data:null==t?void 0:null===(a=t.data)||void 0===a?void 0:a.data}}catch(e){return{success:!1,e:(null==e?void 0:null===(i=e.response)||void 0===i?void 0:null===(t=i.data)||void 0===t?void 0:t.error)||(null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(o=n.data)||void 0===o?void 0:o.message)}}},edit:async(e,l,a)=>{var t,i,o,n,r;try{let i=await d.Z.patch("".concat(s,"/editDelivery"),{id:e,...l,staff:a});return{success:!0,data:null==i?void 0:null===(t=i.data)||void 0===t?void 0:t.data}}catch(e){return{success:!1,e:(null==e?void 0:null===(o=e.response)||void 0===o?void 0:null===(i=o.data)||void 0===i?void 0:i.error)||(null==e?void 0:null===(r=e.response)||void 0===r?void 0:null===(n=r.data)||void 0===n?void 0:n.message)}}},editReceivedMoney:async(e,l,a)=>{var t,i,o,n,r;try{let i=await d.Z.patch("".concat(s,"/editReceivedMoney"),{id:e,money:l,staff:a});return{success:!0,data:null==i?void 0:null===(t=i.data)||void 0===t?void 0:t.data}}catch(e){return{success:!1,e:(null==e?void 0:null===(o=e.response)||void 0===o?void 0:null===(i=o.data)||void 0===i?void 0:i.error)||(null==e?void 0:null===(r=e.response)||void 0===r?void 0:null===(n=r.data)||void 0===n?void 0:n.message)}}},editDesc:async(e,l,a)=>{var t,i,o,n,r;try{let i=await d.Z.patch("".concat(s,"/editDesc"),{id:e,desc:l,field:a});return{success:!0,data:null==i?void 0:null===(t=i.data)||void 0===t?void 0:t.data}}catch(e){return{success:!1,e:(null==e?void 0:null===(o=e.response)||void 0===o?void 0:null===(i=o.data)||void 0===i?void 0:i.error)||(null==e?void 0:null===(r=e.response)||void 0===r?void 0:null===(n=r.data)||void 0===n?void 0:n.message)}}},verify:async(e,l,a)=>{var t,i,o,n,r;try{let i=await d.Z.patch("".concat(s,"/verify"),{id:e,verify:l,staff:a});return{success:!0,data:null==i?void 0:null===(t=i.data)||void 0===t?void 0:t.data}}catch(e){return{success:!1,e:(null==e?void 0:null===(o=e.response)||void 0===o?void 0:null===(i=o.data)||void 0===i?void 0:i.error)||(null==e?void 0:null===(r=e.response)||void 0===r?void 0:null===(n=r.data)||void 0===n?void 0:n.message)}}},getDeliveryrCustomer:async(e,l,a,t,o,n,r,c,u,v,m,x)=>{try{var h,p;let g=await d.Z.get("".concat(s,"/getDeliveryCustomer"),{params:{startLimit:e,endLimit:l,order:a,sort:t,search:o,value:n,startDate:r?i()(r).format("YYYY-MM-DD 00:00:00"):null,endDate:c?i()(c).format("YYYY-MM-DD 23:59:59"):null,status:u,id:v,action:m,type:x}});return{success:!0,data:null==g?void 0:null===(h=g.data)||void 0===h?void 0:h.data,pagination:null==g?void 0:null===(p=g.data)||void 0===p?void 0:p.pagination}}catch(e){return{success:!1,e}}},importExcel:async(e,l)=>{var a,t,i,o,n,r;try{let i=new FormData;i.append("excelFile",e);let o=await d.Z.post("".concat(s,"/uploadExcelFile"),i,{params:{staff:l}});return{status:null==o?void 0:null===(a=o.data)||void 0===a?void 0:a.status,message:null==o?void 0:null===(t=o.data)||void 0===t?void 0:t.message}}catch(e){return{status:null==e?void 0:null===(o=e.response)||void 0===o?void 0:null===(i=o.data)||void 0===i?void 0:i.status,message:null==e?void 0:null===(r=e.response)||void 0===r?void 0:null===(n=r.data)||void 0===n?void 0:n.message}}},bulkPrint:async e=>{try{var l,a;let t=await d.Z.post("".concat(s,"/changeStatusQR"),{params:{id:e}});return{success:!0,data:null==t?void 0:null===(l=t.data)||void 0===l?void 0:l.data,pagination:null==t?void 0:null===(a=t.data)||void 0===a?void 0:a.pagination}}catch(e){return{success:!1,e}}},checkDeliveryList:async(e,l,a)=>{try{var t,i;let o=await d.Z.get("".concat(s,"/checkDelivery"),{params:{startLimit:e,endLimit:l,search:a}});return{success:!0,data:null==o?void 0:null===(t=o.data)||void 0===t?void 0:t.data,pagination:null==o?void 0:null===(i=o.data)||void 0===i?void 0:i.pagination}}catch(e){return{success:!1,e}}}}},19203:function(e,l,a){a.r(l);var d=a(85893),t=a(78426),i=a(46614),s=a(43681),o=a(60946),n=a(86414),r=a(23583),c=a(67294),u=a(88767),v=a(50817);a(68755);var m=a(27484),x=a.n(m),h=a(79153),p=a(11163);l.default=()=>{var e,l,a,m,g,y,f,j,b,N,w,D,_,Z,Y,T;let{user:M}=(0,s.a)(),Q=(0,p.useRouter)(),[k,C]=(0,c.useState)(),R=[{img:"/warning/1-light.svg",text:"Хайлна"},{img:"/warning/2-light.svg",text:"Хөлдөнө"},{img:"/warning/3-light.svg",text:"Сэгсэрч болохгүй"},{img:"/warning/4-light.svg",text:"Хагарна"}],{data:z}=(0,u.useQuery)(["last-delivery-cus"],()=>i.Z.getDeliveryrCustomer(0,8,"delivery.created_at","desc","","","","",100,null==M?void 0:M.user_id),{enabled:(null==M?void 0:M.role)==="customer"}),{data:E}=(0,u.useQuery)(["report-details"],()=>t.Z.getReport(),{enabled:(null==M?void 0:M.role)==="admin"||(null==M?void 0:M.role)==="manager",staleTime:6e5,cacheTime:12e5}),{data:S}=(0,u.useQuery)(["report-details-cus"],()=>t.Z.getReport(null==M?void 0:M.user_id),{enabled:(null==M?void 0:M.role)==="customer"}),{data:F}=(0,u.useQuery)(["delivery-chart"],()=>t.Z.getDeliveryCount(),{enabled:(null==M?void 0:M.role)==="admin"||(null==M?void 0:M.role)==="manager",staleTime:6e5,cacheTime:12e5}),{data:A}=(0,u.useQuery)(["delivery-customer-chart"],()=>t.Z.getDeliveryCount(null==M?void 0:M.user_id),{enabled:(null==M?void 0:M.role)==="customer"}),{data:H}=(0,u.useQuery)(["total-list"],async()=>t.Z.getTotal("delivery","delivery_archive"),{enabled:(null==M?void 0:M.role)==="admin"||(null==M?void 0:M.role)==="manager",staleTime:6e5,cacheTime:12e5}),{data:K}=(0,u.useQuery)(["total-list-deli"],()=>t.Z.getTotal("delivery",null,null==M?void 0:M.user_id),{enabled:(null==M?void 0:M.role)==="customer"}),{data:L}=(0,u.useQuery)(["total-list-order"],()=>t.Z.getTotal("orders","orders_archive"),{enabled:(null==M?void 0:M.role)==="admin"||(null==M?void 0:M.role)==="manager",staleTime:6e5,cacheTime:12e5}),{data:W}=(0,u.useQuery)(["total-list-cus"],()=>t.Z.getTotal("orders",null,null==M?void 0:M.user_id),{enabled:(null==M?void 0:M.role)==="customer"}),{data:I}=(0,u.useQuery)(["total-list-report"],()=>t.Z.getTotal("report_cus",null),{enabled:(null==M?void 0:M.role)==="admin"||(null==M?void 0:M.role)==="manager",staleTime:6e5,cacheTime:12e5}),{data:P}=(0,u.useQuery)(["total-list-report-cus"],()=>t.Z.getTotal("report_cus",null,null==M?void 0:M.user_id),{enabled:(null==M?void 0:M.role)==="customer"}),{data:q}=(0,u.useQuery)(["delivery-list-dashboard"],()=>i.Z.find(0,8,"delivery.created_at","desc","","","","",100),{enabled:(null==M?void 0:M.role)==="admin"||(null==M?void 0:M.role)==="manager",staleTime:6e5,cacheTime:12e5});return(0,d.jsxs)("div",{className:"grid md:grid-cols-3 grid-cols-1 gap-4",children:[(0,d.jsxs)("div",{className:"col-span-2 flex flex-col gap-4",children:[(0,d.jsxs)("div",{className:"justify-between p-4 items-center h-[140px] bg-white rounded-xl border border-slate-100 md:flex hidden",children:[(0,d.jsxs)("div",{className:"",children:[(0,d.jsxs)("h1",{className:"text-indigo-600 font-bold text-xl mb-2",children:["Сайн байна уу! ",null==M?void 0:M.last_name]}),(0,d.jsx)("p",{className:"text-sm",children:"Танд энэ өдрийн мэндийг хүргэе! манай Буухиа элч хүргэлтийн системийг өөрийн бизнестээ ашиглаж байгаад баярлалаа"})]}),(0,d.jsx)("img",{src:"/icons/dashboard.svg",alt:"dashboard",className:"mt-[-25px]"})]}),(0,d.jsxs)("div",{className:"grid md:grid-cols-2 grid-cols-1 gap-4",children:[(0,d.jsxs)("div",{className:"h-auto bg-white text-sm rounded-xl border border-slate-100 p-5",children:[(0,d.jsx)("h1",{className:"font-semibold mb-4",children:"Сүүлийн тайлангууд"}),(0,d.jsxs)("div",{className:"grid grid-cols-3 text-indigo-500 sticky top-0 text-sm",children:[(0,d.jsx)("p",{className:"flex justify-start",children:"Дүн"}),(0,d.jsx)("p",{className:"flex justify-center",children:"Хүргэлт үнэ"}),(0,d.jsx)("p",{className:"flex justify-end",children:"Зөрүү"})]}),(0,d.jsx)("div",{className:"border-b w-full mt-2 mb-1"}),(0,d.jsx)("div",{className:"overflow-y-scroll xl:h-[300px] 2xl:h-[350px]",children:(null==E?void 0:null===(e=E.data)||void 0===e?void 0:e.length)>0||(null==S?void 0:null===(l=S.data)||void 0===l?void 0:l.length)>0?null===(a=(null==E?void 0:E.data)||(null==S?void 0:S.data))||void 0===a?void 0:a.map(e=>(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"grid grid-cols-3 text-sm pt-2",children:[(0,d.jsxs)("div",{className:"flex flex-col justify-start gap-2",children:[(0,d.jsx)("p",{className:"text-xs",children:x()(null==e?void 0:e.created_at).format("YYYY/MM/DD HH:mm")}),(0,d.jsxs)("p",{children:["₮",(0,o.uf)(null==e?void 0:e.sum)]})]}),(0,d.jsxs)("div",{className:"flex justify-center",children:["₮",(0,o.uf)(null==e?void 0:e.payment)]}),(0,d.jsxs)("div",{className:"flex flex-col gap-2 justify-end",children:[(0,d.jsxs)("p",{className:"font-bold flex justify-end",children:["₮",(0,o.uf)(null==e?void 0:e.zoruu)]}),(0,d.jsx)("p",{className:" text-xs flex justify-end ",children:(null==e?void 0:e.pay)==0?(0,d.jsx)("p",{className:"text-red-600",children:"Төлбөр шилжээгүй"}):(0,d.jsx)("p",{className:"text-green-600",children:"Төлбөр шилжсэн"})})]})]}),(0,d.jsx)("div",{className:"border-b border-indigo-500 w-full mt-3 mb-1"})]},"report-".concat(null==e?void 0:e.id))):(0,d.jsxs)("div",{className:"flex flex-col items-center mb-10",children:[(0,d.jsx)("img",{alt:"noting found",src:"/icons/no-data.svg",className:"w-1/3 mt-10"}),(0,d.jsx)("div",{className:"text-center text-zinc-900 text-opacity-40 text-xl font-bold",children:"Илэрц олдсонгүй"})]})})]}),(0,d.jsxs)("div",{className:"h-auto bg-white rounded-xl border border-slate-100 p-4",children:[(0,d.jsx)("h1",{className:"font-semibold text-sm mb-8",children:"Хүргэлтийн график"}),(0,d.jsx)(v.v,{h:300,data:(null==F?void 0:F.data)||(null==A?void 0:A.data)||[],dataKey:"month",series:[{name:"Хүргэгдсэн",color:"violet.6"},{name:"Буцаасан",color:"pink.6"},{name:"Цуцалсан",color:"red.6"}],tickLine:"y"})]})]}),(0,d.jsx)("h1",{className:"font-semibold text-sm",children:"Та манай системийг ашиглан нийт"}),(0,d.jsxs)("div",{className:"flex items-start sm:gap-4 gap-1",children:[(0,d.jsxs)("div",{className:"flex items-center gap-4 bg-white h-24 rounded-xl border border-slate-100 p-4 w-1/3",children:[(0,d.jsx)("div",{className:"flex justify-center items-center p-2 bg-green-200 rounded-full",children:(0,d.jsx)("img",{src:"/icons/dashboard-1.svg",alt:"car"})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"font-bold",children:(0,o.uf)((null==H?void 0:null===(m=H.data)||void 0===m?void 0:m.total)||(null==K?void 0:null===(g=K.data)||void 0===g?void 0:g.total))}),(0,d.jsx)("p",{className:"text-zinc-900 text-opacity-40 text-xs font-normal",children:"Хүргэлт"})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-4 bg-white h-24 rounded-xl border border-slate-100 p-5 w-1/3",children:[(0,d.jsx)("div",{className:"flex justify-center items-center p-2 bg-indigo-500 bg-opacity-40 rounded-full",children:(0,d.jsx)("img",{src:"/icons/dashboard-2.svg",alt:"car"})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"font-bold",children:(0,o.uf)((null==L?void 0:null===(y=L.data)||void 0===y?void 0:y.total)||(null==W?void 0:null===(f=W.data)||void 0===f?void 0:f.total))}),(0,d.jsx)("p",{className:"text-zinc-900 text-opacity-40 text-xs font-normal",children:"Захиалга"})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-4 bg-white h-24 rounded-xl border border-slate-100 p-5 w-1/3",children:[(0,d.jsx)("div",{className:"flex justify-center items-center p-2 bg-red-500 bg-opacity-40 rounded-full",children:(0,d.jsx)("img",{src:"/icons/dashboard-3.svg",alt:"car"})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"font-bold",children:(0,o.uf)((null==I?void 0:null===(j=I.data)||void 0===j?void 0:j.total)||(null==P?void 0:null===(b=P.data)||void 0===b?void 0:b.total)||0)}),(0,d.jsx)("p",{className:"text-zinc-900 text-opacity-40 text-xs font-normal",children:"Тайлан"})]})]})]})]}),(0,d.jsxs)("div",{className:"col-span-1 w-full",children:[(null==M?void 0:M.role)!=="customer"&&(0,d.jsx)(n.o,{type:"text",leftSection:(0,d.jsx)(h.Z,{}),className:"w-full mb-4",placeholder:"Хайх ... ",onChange:e=>C(e.target.value),onKeyDown:e=>{"Enter"===e.key&&Q.push("/globalSearch/".concat(k||""))}}),(0,d.jsxs)("div",{className:"bg-white rounded-xl border 2xl:h-[800px] xl:h-[720px] border-slate-100 p-4",children:[(0,d.jsx)("h1",{className:"font-semibold mb-4 text-sm",children:"Сүүлд үүсгэсэн хүргэлтүүд"}),(0,d.jsx)("div",{className:"flex flex-col gap-4 2xl:h-[730px] xl:h-[650px] overflow-scroll",children:((null==q?void 0:null===(w=q.data)||void 0===w?void 0:null===(N=w.result)||void 0===N?void 0:N.length)||(null==z?void 0:null===(_=z.data)||void 0===_?void 0:null===(D=_.result)||void 0===D?void 0:D.length))>0?null===(Z=(null==q?void 0:null===(Y=q.data)||void 0===Y?void 0:Y.result)||(null==z?void 0:null===(T=z.data)||void 0===T?void 0:T.result))||void 0===Z?void 0:Z.map((e,l)=>(0,d.jsxs)("div",{className:"border rounded-lg border-indigo-500 border-opacity-40 h-[155px] p-2 space-y-[5px] text-sm relative",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:["ID",(0,d.jsx)("span",{className:"text-gray-400 ml-3",children:null==e?void 0:e.code})]}),(0,d.jsxs)("div",{className:"font-semibold",children:["₮",(0,o.uf)((null==e?void 0:e.total_price)||0)]})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-2 font-semibold",children:[(0,d.jsx)("p",{children:"Дэлгүүрийн нэр:"}),(0,d.jsx)("p",{children:null==e?void 0:e.shop_name})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("p",{children:null==e?void 0:e.cus_name}),(0,d.jsx)("p",{children:null==e?void 0:e.cus_phone})]}),(0,d.jsx)("div",{className:"text-gray-400 h-8 truncate",children:"".concat((null==e?void 0:e.city)||""," ").concat((null==e?void 0:e.district)||""," ").concat((null==e?void 0:e.committee)||""," ").concat((null==e?void 0:e.street)||""," ").concat((null==e?void 0:e.toot)||"")}),(0,d.jsx)("div",{className:"pt-1 truncate",children:(null==e?void 0:e.addition)||""}),(0,d.jsxs)("div",{className:"flex items-center absolute bottom-[-15px]",children:["Шуурхай"==e.type&&(0,d.jsx)(r.u,{label:"Шуурхай хүргэлт",children:(0,d.jsx)("div",{className:"bg-yellow-500 py-1.5 px-2 rounded-lg mr-2",children:(0,d.jsx)("img",{src:"/warning/car-light.svg",alt:"",className:"w-5"})})}),null==R?void 0:R.filter(l=>(null==l?void 0:l.text)==(null==e?void 0:e.item_type)).map(e=>(0,d.jsxs)("div",{className:"bg-indigo-500 text-white w-auto flex items-center rounded-lg space-x-1 py-1.5 px-2",children:[(0,d.jsx)("img",{src:null==e?void 0:e.img,className:"w-5",alt:"icon"}),(0,d.jsx)("p",{children:null==e?void 0:e.text})]},"warning-".concat(l)))]})]},"dashbaord-".concat(l))):(0,d.jsx)("div",{children:"Хүргэлт байхгүй байна."})})]})]})]})}}}]);
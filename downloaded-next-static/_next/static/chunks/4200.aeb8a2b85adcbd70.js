"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4200],{89081:function(e,a,t){t.d(a,{Z:function(){return n}});var n=(0,t(30853).Z)("device-mobile","IconDeviceMobile",[["path",{d:"M6 5a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2v-14z",key:"svg-0"}],["path",{d:"M11 4h2",key:"svg-1"}],["path",{d:"M12 17v.01",key:"svg-2"}]])},2891:function(e,a,t){t.d(a,{Z:function(){return n}});var n=(0,t(30853).Z)("map-pin","IconMapPin",[["path",{d:"M9 11a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-0"}],["path",{d:"M17.657 16.657l-4.243 4.243a2 2 0 0 1 -2.827 0l-4.244 -4.243a8 8 0 1 1 11.314 0z",key:"svg-1"}]])},81421:function(e,a,t){t.d(a,{Z:function(){return n}});var n=(0,t(30853).Z)("phone-call","IconPhoneCall",[["path",{d:"M5 4h4l2 5l-2.5 1.5a11 11 0 0 0 5 5l1.5 -2.5l5 2v4a2 2 0 0 1 -2 2a16 16 0 0 1 -15 -15a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M15 7a2 2 0 0 1 2 2",key:"svg-1"}],["path",{d:"M15 3a6 6 0 0 1 6 6",key:"svg-2"}]])},8861:function(e,a,t){t.d(a,{Z:function(){return n}});var n=(0,t(30853).Z)("user","IconUser",[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2",key:"svg-1"}]])},98298:function(e,a,t){var n=t(18992),o=t(27484),r=t.n(o);let l="/api/v1";a.Z={find:async(e,a,t,o,i,d,s,u,c)=>{try{var v,p;let h=await n.Z.get("".concat(l,"/order"),{params:{startLimit:e,endLimit:a,order:t,sort:o,search:i,value:d,startDate:s?r()(s).format("YYYY-MM-DD 00:00:00"):null,endDate:u?r()(u).format("YYYY-MM-DD 23:59:59"):null,status:c}});return{success:!0,data:null==h?void 0:null===(v=h.data)||void 0===v?void 0:v.data,pagination:null==h?void 0:null===(p=h.data)||void 0===p?void 0:p.pagination}}catch(e){return{success:!1,e}}},findArchive:async(e,a,t,o,i,d,s,u)=>{try{var c,v;let p=await n.Z.get("".concat(l,"/orderArchive"),{params:{startLimit:e,endLimit:a,order:t,sort:o,search:i,value:d,startDate:s?r()(s).format("YYYY-MM-DD 00:00:00"):null,endDate:u?r()(u).format("YYYY-MM-DD 23:59:59"):null}});return{success:!0,data:null==p?void 0:null===(c=p.data)||void 0===c?void 0:c.data,pagination:null==p?void 0:null===(v=p.data)||void 0===v?void 0:v.pagination}}catch(e){return{success:!1,e}}},create:async(e,a)=>{var t,o,r,i,d;try{let o=await n.Z.post("".concat(l,"/createOrder"),{...e,staff:a});return{success:!0,data:null==o?void 0:null===(t=o.data)||void 0===t?void 0:t.data}}catch(e){return{success:!1,e:(null==e?void 0:null===(r=e.response)||void 0===r?void 0:null===(o=r.data)||void 0===o?void 0:o.error)||(null==e?void 0:null===(d=e.response)||void 0===d?void 0:null===(i=d.data)||void 0===i?void 0:i.message)}}},receivedDriver:async(e,a,t,o,i,d,s,u)=>{var c,v,p,h,f,g;try{let p=await n.Z.get("".concat(l,"/receivedDriver"),{params:{startLimit:e,endLimit:a,order:t,sort:o,search:i,value:d,startDate:s?r()(s).format("YYYY-MM-DD 00:00:00"):null,endDate:u?r()(u).format("YYYY-MM-DD 23:59:59"):null}});return{success:!0,data:null==p?void 0:null===(c=p.data)||void 0===c?void 0:c.data,pagination:null==p?void 0:null===(v=p.data)||void 0===v?void 0:v.pagination}}catch(e){return{success:!1,e:(null==e?void 0:null===(h=e.response)||void 0===h?void 0:null===(p=h.data)||void 0===p?void 0:p.error)||(null==e?void 0:null===(g=e.response)||void 0===g?void 0:null===(f=g.data)||void 0===f?void 0:f.message)}}},finishedOrder:async(e,a,t,o,r,i)=>{var d,s,u,c,v,p;try{let u=await n.Z.get("".concat(l,"/finishedOrder"),{params:{startLimit:e,endLimit:a,order:t,sort:o,search:r,value:i}});return{success:!0,data:null==u?void 0:null===(d=u.data)||void 0===d?void 0:d.data,pagination:null==u?void 0:null===(s=u.data)||void 0===s?void 0:s.pagination}}catch(e){return{success:!1,e:(null==e?void 0:null===(c=e.response)||void 0===c?void 0:null===(u=c.data)||void 0===u?void 0:u.error)||(null==e?void 0:null===(p=e.response)||void 0===p?void 0:null===(v=p.data)||void 0===v?void 0:v.message)}}},report:async(e,a,t,o,i,d,s,u)=>{var c,v,p,h,f,g;try{let p=await n.Z.get("".concat(l,"/reportOrder"),{params:{startLimit:e,endLimit:a,order:t,sort:o,search:i,value:d,startDate:s?r()(s).format("YYYY-MM-DD 00:00:00"):null,endDate:u?r()(u).format("YYYY-MM-DD 23:59:59"):null}});return{success:!0,data:null==p?void 0:null===(c=p.data)||void 0===c?void 0:c.data,pagination:null==p?void 0:null===(v=p.data)||void 0===v?void 0:v.pagination}}catch(e){return{success:!1,e:(null==e?void 0:null===(h=e.response)||void 0===h?void 0:null===(p=h.data)||void 0===p?void 0:p.error)||(null==e?void 0:null===(g=e.response)||void 0===g?void 0:null===(f=g.data)||void 0===f?void 0:f.message)}}},changeDriver:async(e,a,t,o,r)=>{var i,d,s,u,c;try{let d=await n.Z.patch("".concat(l,"/changeStatus2"),{id:e,driver:a,table:t,status:o,staff:r});return{success:!0,data:null==d?void 0:null===(i=d.data)||void 0===i?void 0:i.data}}catch(e){return{success:!1,e:(null==e?void 0:null===(s=e.response)||void 0===s?void 0:null===(d=s.data)||void 0===d?void 0:d.error)||(null==e?void 0:null===(c=e.response)||void 0===c?void 0:null===(u=c.data)||void 0===u?void 0:u.message)}}},changeStatus:async(e,a,t,o)=>{var r,i,d,s,u;try{let i=await n.Z.patch("".concat(l,"/changeStatus"),{id:e,status:a,table:t,staff:o});return{success:!0,data:null==i?void 0:null===(r=i.data)||void 0===r?void 0:r.data}}catch(e){return{success:!1,e:(null==e?void 0:null===(d=e.response)||void 0===d?void 0:null===(i=d.data)||void 0===i?void 0:i.error)||(null==e?void 0:null===(u=e.response)||void 0===u?void 0:null===(s=u.data)||void 0===s?void 0:s.message)}}},changeRegion:async(e,a,t,o)=>{var r,i,d,s,u;try{let i=await n.Z.patch("".concat(l,"/changeRegion"),{id:e,region:a,table:t,staff:o});return{success:!0,data:null==i?void 0:null===(r=i.data)||void 0===r?void 0:r.data}}catch(e){return{success:!1,e:(null==e?void 0:null===(d=e.response)||void 0===d?void 0:null===(i=d.data)||void 0===i?void 0:i.error)||(null==e?void 0:null===(u=e.response)||void 0===u?void 0:null===(s=u.data)||void 0===s?void 0:s.message)}}},changeRegionOrder:async(e,a)=>{var t,o,r,i,d;try{let o=await n.Z.patch("".concat(l,"/changeRegionOrder"),{id:e,region:a});return{success:!0,data:null==o?void 0:null===(t=o.data)||void 0===t?void 0:t.data}}catch(e){return{success:!1,e:(null==e?void 0:null===(r=e.response)||void 0===r?void 0:null===(o=r.data)||void 0===o?void 0:o.error)||(null==e?void 0:null===(d=e.response)||void 0===d?void 0:null===(i=d.data)||void 0===i?void 0:i.message)}}},edit:async(e,a,t)=>{var o,r,i,d,s;try{let r=await n.Z.patch("".concat(l,"/editOrder"),{id:e,...a,staff:t});return{success:!0,data:null==r?void 0:null===(o=r.data)||void 0===o?void 0:o.data}}catch(e){return{success:!1,e:(null==e?void 0:null===(i=e.response)||void 0===i?void 0:null===(r=i.data)||void 0===r?void 0:r.error)||(null==e?void 0:null===(s=e.response)||void 0===s?void 0:null===(d=s.data)||void 0===d?void 0:d.message)}}},getById:async(e,a)=>{var t,o,r,i,d;try{let o=await n.Z.get("".concat(l,"/getById"),{params:{id:e,table:a}});return{success:!0,data:null==o?void 0:null===(t=o.data)||void 0===t?void 0:t.data}}catch(e){return{success:!1,e:(null==e?void 0:null===(r=e.response)||void 0===r?void 0:null===(o=r.data)||void 0===o?void 0:o.error)||(null==e?void 0:null===(d=e.response)||void 0===d?void 0:null===(i=d.data)||void 0===i?void 0:i.message)}}},getOrderCustomer:async(e,a,t,o,i,d,s,u,c,v)=>{try{var p,h;let f=await n.Z.get("".concat(l,"/getOrderCustomer"),{params:{startLimit:e,endLimit:a,order:t,sort:o,search:i,value:d,startDate:s?r()(s).format("YYYY-MM-DD 00:00:00"):null,endDate:u?r()(u).format("YYYY-MM-DD 23:59:59"):null,status:c,id:v}});return{success:!0,data:null==f?void 0:null===(p=f.data)||void 0===p?void 0:p.data,pagination:null==f?void 0:null===(h=f.data)||void 0===h?void 0:h.pagination}}catch(e){return{success:!1,e}}}}},64200:function(e,a,t){t.r(a);var n=t(85893),o=t(67294),r=t(10330),l=t(83050),i=t(95085),d=t(36616),s=t(86414),u=t(94694),c=t(70140),v=t(47181),p=t(8861),h=t(75928),f=t(81421),g=t(89081),m=t(2891),b=t(88198),y=t(88767),x=t(26148),_=t(98298),w=t(60946),S=t(11163),D=t(43681);a.default=()=>{var e,a,t,j,M,Y,z,Z,P;let O=(0,S.useRouter)(),[R,F]=(0,o.useState)(),[A,L]=(0,o.useState)(),{user:N}=(0,D.a)(),k=(0,r.c)({initialValues:{user_id:null,branch_id:null},validate:{user_id:e=>null==e?"dsds":null,branch_id:e=>null==e?"Салбар сонгоно уу!":null}});(0,o.useEffect)(()=>{k.setFieldValue("branch_id",null),(null==N?void 0:N.role)==="customer"&&F(null==N?void 0:N.user_id)},[R]),(0,o.useEffect)(()=>{(null==N?void 0:N.role)==="customer"&&(F(null==N?void 0:N.user_id),k.setFieldValue("user_id",null==N?void 0:N.user_id))},[N]);let E=(0,y.useMutation)(["create-order"],e=>_.Z.create(e,null==N?void 0:N.last_name),{onSuccess(e){(null==e?void 0:e.success)===!0?((null==N?void 0:N.role)==="customer"?O.push("/order/report"):O.push("/order"),(0,w.PV)({message:"Захиалга илгээгдлээ.",status:!0})):(0,w.PV)({message:null==e?void 0:e.e,status:!1})}}),{data:I}=(0,y.useQuery)(["user-list-order"],()=>x.Z.find(),{enabled:(null==N?void 0:N.role)!="customer"}),{data:T}=(0,y.useQuery)(["branch-list-order",R],()=>R?x.Z.getBranchByUserId(R):Promise.reject()),{data:C}=(0,y.useQuery)(["branch-list",k.values.branch_id],()=>k.values.branch_id?x.Z.getBranchById(k.values.branch_id):Promise.reject()),handleSubmit=e=>{null==E||E.mutateAsync(e)};return(0,n.jsxs)("div",{className:"grid gap-4 sm:grid-cols-3 grid-cols-1 w-full h-screen",children:[(0,n.jsxs)("div",{className:"col-span-2 bg-white rounded-xl p-5 mb-6",children:[(0,n.jsx)("h1",{className:"flex justify-center text-[#6A5ADF] font-bold text-[20px]",children:"Захиалга бүртгэх"}),(0,n.jsxs)(l.x,{className:"mx-2",children:[(0,n.jsx)(i.f,{visible:null==E?void 0:E.isLoading}),(0,n.jsxs)("form",{onSubmit:k.onSubmit(e=>handleSubmit(e)),className:"space-y-4",children:[(null==N?void 0:N.role)!=="customer"&&(0,n.jsx)(d.P,{label:"Харилцагч",leftSection:(0,n.jsx)(p.Z,{size:"1.5rem",color:"#6A5ADF"}),placeholder:"Харилцагч сонгох",data:((null==I?void 0:I.data)||[]).filter(e=>(null==e?void 0:e.role)==="customer").map(e=>({label:(null==e?void 0:e.shop_name)||"",value:null==e?void 0:e.user_id.toString()})),searchable:!0,clearable:!0,nothingFoundMessage:"Харилцагч олдсонгүй эсвэл харилцагч нэмнэ үү.",onChange:e=>{F(e),k.setFieldValue("user_id",e)},disabled:(null==N?void 0:N.role)==="customer"}),(0,n.jsx)(d.P,{label:"Салбар",leftSection:(0,n.jsx)(h.Z,{size:"1.5rem",color:"#6A5ADF"}),placeholder:"Салбар сонгох",data:((null==T?void 0:T.data)||[]).filter(e=>(null==e?void 0:e.approve)===1).map((e,a)=>({value:null==e?void 0:e.branch_id.toString(),label:(null==e?void 0:e.name)||""})),...k.getInputProps("branch_id"),searchable:!0,nothingFoundMessage:"Салбар олдсонгүй эсвэл салбар нэмнэ үү."}),(0,n.jsxs)("div",{className:"relative flex space-x-6 items-center",children:[(0,n.jsx)(s.o,{label:"Холбогдох дугаар",leftSection:(0,n.jsx)(f.Z,{size:"1.5rem",color:"#6A5ADF"}),className:"w-1/2",placeholder:"Сонгогдсон салбарын дугаар 1",disabled:!0,defaultValue:(null==C?void 0:null===(e=C.data)||void 0===e?void 0:e.branch_phone)||""}),(0,n.jsx)(s.o,{label:" ",leftSection:(0,n.jsx)(g.Z,{size:"1.5rem",color:"#6A5ADF"}),className:"w-1/2",placeholder:"Сонгогдсон салбарын дугаар 2",disabled:!0,defaultValue:(null==C?void 0:null===(a=C.data)||void 0===a?void 0:a.branch_phone1)||""})]}),(0,n.jsx)(s.o,{label:"Хаяг",leftSection:(0,n.jsx)(m.Z,{size:"1.5rem",color:"#6A5ADF"}),placeholder:"Сонгогдсон салбарын хаяг",disabled:!0,value:(null==C?void 0:C.data)?"".concat(null==C?void 0:null===(t=C.data)||void 0===t?void 0:t.city,", ").concat(null==C?void 0:null===(j=C.data)||void 0===j?void 0:j.district,", ").concat(null==C?void 0:null===(M=C.data)||void 0===M?void 0:M.committee,", ").concat(null==C?void 0:null===(Y=C.data)||void 0===Y?void 0:Y.street,", ").concat(null==C?void 0:null===(z=C.data)||void 0===z?void 0:z.toot,", ").concat(null==C?void 0:null===(Z=C.data)||void 0===Z?void 0:Z.branch_address):""}),(0,n.jsx)(s.o,{label:"Хаяг нэмэлт мэдээлэл",leftSection:(0,n.jsx)(m.Z,{size:"1.5rem",color:"#6A5ADF"}),placeholder:"Сонгогдсон салбарын хаяг нэмэлт мэдээлэл",disabled:!0,defaultValue:(null==C?void 0:null===(P=C.data)||void 0===P?void 0:P.branch_addition)||""}),(0,n.jsx)(u.g,{label:"Нэмэлт тайлбар",placeholder:"Тайлбар бичих",...k.getInputProps("order_desc")}),(0,n.jsx)(c.Z,{justify:"center",mt:"md",children:(0,n.jsx)(v.z,{type:"submit",radius:9,color:"#6A5ADF",leftSection:(0,n.jsx)(b.Z,{}),children:"Хадгалах"})})]})]})]}),(0,n.jsx)("div",{className:"space-y-6",children:(0,n.jsx)("div",{className:"bg-white h-1/3 rounded-xl p-5"})})]})}},86414:function(e,a,t){t.d(a,{o:function(){return h}});var n=t(67294),o=t(12440),r=t(9535),l=t(90987),i=Object.defineProperty,d=Object.defineProperties,s=Object.getOwnPropertyDescriptors,u=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,a,t)=>a in e?i(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,__spreadValues=(e,a)=>{for(var t in a||(a={}))c.call(a,t)&&__defNormalProp(e,t,a[t]);if(u)for(var t of u(a))v.call(a,t)&&__defNormalProp(e,t,a[t]);return e},__spreadProps=(e,a)=>d(e,s(a));let p={},h=(0,r.d)((e,a)=>{let t=(0,l.w)("TextInput",p,e);return n.createElement(o.M,__spreadProps(__spreadValues({component:"input",ref:a},t),{__staticSelector:"TextInput"}))});h.classes=o.M.classes,h.displayName="@mantine/core/TextInput"},94694:function(e,a,t){t.d(a,{g:function(){return S}});var n=t(67294),o=t(87462),r=t(63366),l=n.useLayoutEffect,useLatest=function(e){var a=n.useRef(e);return l(function(){a.current=e}),a},updateRef=function(e,a){if("function"==typeof e){e(a);return}e.current=a},use_composed_ref_esm=function(e,a){var t=(0,n.useRef)();return(0,n.useCallback)(function(n){e.current=n,t.current&&updateRef(t.current,null),t.current=a,a&&updateRef(a,n)},[a])},i={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},forceHiddenStyles$1=function(e){Object.keys(i).forEach(function(a){e.style.setProperty(a,i[a],"important")})},d=null,getHeight=function(e,a){var t=e.scrollHeight;return"border-box"===a.sizingStyle.boxSizing?t+a.borderSize:t-a.paddingSize},noop=function(){},s=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],u=!!document.documentElement.currentStyle,getSizingData$1=function(e){var a=window.getComputedStyle(e);if(null===a)return null;var t=s.reduce(function(e,t){return e[t]=a[t],e},{}),n=t.boxSizing;if(""===n)return null;u&&"border-box"===n&&(t.width=parseFloat(t.width)+parseFloat(t.borderRightWidth)+parseFloat(t.borderLeftWidth)+parseFloat(t.paddingRight)+parseFloat(t.paddingLeft)+"px");var o=parseFloat(t.paddingBottom)+parseFloat(t.paddingTop),r=parseFloat(t.borderBottomWidth)+parseFloat(t.borderTopWidth);return{sizingStyle:t,paddingSize:o,borderSize:r}};function useListener(e,a,t){var o=useLatest(t);n.useLayoutEffect(function(){var handler=function(e){return o.current(e)};if(e)return e.addEventListener(a,handler),function(){return e.removeEventListener(a,handler)}},[])}var useWindowResizeListener=function(e){useListener(window,"resize",e)},useFontsLoadedListener=function(e){useListener(document.fonts,"loadingdone",e)},c=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],v=n.forwardRef(function(e,a){var t=e.cacheMeasurements,l=e.maxRows,i=e.minRows,s=e.onChange,u=void 0===s?noop:s,v=e.onHeightChange,p=void 0===v?noop:v,h=(0,r.Z)(e,c),f=void 0!==h.value,g=n.useRef(null),m=use_composed_ref_esm(g,a),b=n.useRef(0),y=n.useRef(),resizeTextarea=function(){var e,a,n,o,r,s,u,c,v,h,f,m=g.current,x=t&&y.current?y.current:getSizingData$1(m);if(x){y.current=x;var _=(e=m.value||m.placeholder||"x",void 0===(a=i)&&(a=1),void 0===(n=l)&&(n=1/0),d||((d=document.createElement("textarea")).setAttribute("tabindex","-1"),d.setAttribute("aria-hidden","true"),forceHiddenStyles$1(d)),null===d.parentNode&&document.body.appendChild(d),o=x.paddingSize,r=x.borderSize,u=(s=x.sizingStyle).boxSizing,Object.keys(s).forEach(function(e){d.style[e]=s[e]}),forceHiddenStyles$1(d),d.value=e,c=getHeight(d,x),d.value=e,c=getHeight(d,x),d.value="x",h=(v=d.scrollHeight-o)*a,"border-box"===u&&(h=h+o+r),c=Math.max(h,c),f=v*n,"border-box"===u&&(f=f+o+r),[c=Math.min(f,c),v]),w=_[0],S=_[1];b.current!==w&&(b.current=w,m.style.setProperty("height",w+"px","important"),p(w,{rowHeight:S}))}};return n.useLayoutEffect(resizeTextarea),useWindowResizeListener(resizeTextarea),useFontsLoadedListener(resizeTextarea),n.createElement("textarea",(0,o.Z)({},h,{onChange:function(e){f||resizeTextarea(),u(e)},ref:m}))}),p=t(12440),h=t(9535),f=t(90987),g=Object.defineProperty,m=Object.defineProperties,b=Object.getOwnPropertyDescriptors,y=Object.getOwnPropertySymbols,x=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,a,t)=>a in e?g(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,__spreadValues=(e,a)=>{for(var t in a||(a={}))x.call(a,t)&&__defNormalProp(e,t,a[t]);if(y)for(var t of y(a))_.call(a,t)&&__defNormalProp(e,t,a[t]);return e},__spreadProps=(e,a)=>m(e,b(a)),__objRest=(e,a)=>{var t={};for(var n in e)x.call(e,n)&&0>a.indexOf(n)&&(t[n]=e[n]);if(null!=e&&y)for(var n of y(e))0>a.indexOf(n)&&_.call(e,n)&&(t[n]=e[n]);return t};let w={},S=(0,h.d)((e,a)=>{let t=(0,f.w)("Textarea",w,e),{autosize:o,maxRows:r,minRows:l,__staticSelector:i}=t,d=__objRest(t,["autosize","maxRows","minRows","__staticSelector"]),s=o?{maxRows:r,minRows:l}:{};return n.createElement(p.M,__spreadValues(__spreadProps(__spreadValues({component:o?v:"textarea",ref:a},d),{__staticSelector:i||"Textarea",multiline:!0,"data-no-overflow":o&&void 0===r||void 0}),s))});S.classes=p.M.classes,S.displayName="@mantine/core/Textarea"}}]);